<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Demo Timeline noUiSlider</title>
	<link href="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.css" rel="stylesheet">
	<style>
		body {
			font-family: sans-serif;
			margin: 40px;
			background: #f9f9f9;
		}

		.timeline-wrapper {
			position: relative;
			height: 80px;
			margin-bottom: -5px;
		}

		#range-slider, #explore-slider {
			position: absolute;
			width: 100%;
		}

		#range-slider {
			z-index: 2;
		}
		#explore-slider {
			z-index: 3;
			pointer-events: none;
		}
		#explore-slider .noUi-handle {
			pointer-events: auto;
		}

		#range-slider .noUi-connect {
			background: rgba(33, 150, 243, 0.5);
		}

		#explore-slider .noUi-connect {
			background: transparent;
		}

		#range-slider .noUi-handle {
			background: #2196f3;
			border: 2px solid #0d47a1;
		}

		#range-slider .noUi-target {
			background: rgba(250, 250, 250, 0.49);
			border: 2px solid #0d47a1;
		}

		#explore-slider .noUi-handle {
			background: transparent;
			border: none;
			width: 0;
			height: 0;
			border-left: 15px solid transparent;
			border-right: 15px solid transparent;
			border-bottom: 25px solid #ffc107;
			top: -10px;
		}

		.timeline-scale {
			display: flex;
			justify-content: space-between;
			align-items: flex-start;
			font-size: 12px;
			color: #666;
			margin-top: -20px;
			padding-top: 0;
			border-top: 1px solid #ccc;
			position: relative;
		}

		.timeline-scale .tick {
			flex: 1;
			text-align: center;
			position: relative;
		}

		.timeline-scale .tick::before {
			content: "";
			position: absolute;
			top: -10px;
			left: 50%;
			transform: translateX(-50%);
			width: 1px;
			height: 20px;
			background: #aaa;
		}

		.highlight-bar {
			position: absolute;
			top: 0;
			height: 20px;
			width: 2px;
			background: red;
			z-index: 4;
			pointer-events: none;
		}

		.info-panels {
			display: flex;
			justify-content: space-between;
			gap: 20px;
			margin-top: 30px;
		}

		.info-box {
			flex: 1;
			background: #fff;
			padding: 15px;
			border: 1px solid #ddd;
			border-radius: 5px;
			box-shadow: 0 2px 5px rgba(0,0,0,0.1);
		}

		.label {
			font-weight: bold;
			margin-bottom: 10px;
		}
	</style>
</head>
<body>
<h2>Timeline avec deux modes superposés</h2>

<div class="timeline-wrapper">
	<div id="range-slider"></div>
	<div id="explore-slider"></div>
</div>
<div class="timeline-scale" id="timeline-scale"></div>

<div class="highlight-bar" id="highlight-bar-range-1"></div>
<div class="highlight-bar" id="highlight-bar-range-2"></div>
<div class="highlight-bar" id="highlight-bar-explore"></div>

<div class="info-panels">
	<div class="info-box">
		<div class="label">Filtrage entre deux dates :</div>
		<div id="range-values"></div>
	</div>
	<div class="info-box">
		<div class="label">Exploration d'une période d'un an :</div>
		<div id="explore-values"></div>
	</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.js"></script>
<script>
	const yearRange = [1900, 2025];

	const rangeSlider = document.getElementById('range-slider');
	noUiSlider.create(rangeSlider, {
		start: [1950, 2000],
		connect: true,
		step: 1,
		range: {
			min: yearRange[0],
			max: yearRange[1]
		},
		tooltips: [true, true],
		format: {
			to: v => Math.round(v),
			from: v => Number(v)
		}
	});

	const exploreSlider = document.getElementById('explore-slider');
	noUiSlider.create(exploreSlider, {
		start: [1975],
		connect: [true, false],
		step: 1,
		range: {
			min: yearRange[0],
			max: yearRange[1] - 1
		},
		tooltips: [true],
		format: {
			to: v => Math.round(v),
			from: v => Number(v)
		}
	});

	const rangeValues = document.getElementById('range-values');
	const exploreValues = document.getElementById('explore-values');

	const highlight1 = document.getElementById('highlight-bar-range-1');
	const highlight2 = document.getElementById('highlight-bar-range-2');
	const highlightExplore = document.getElementById('highlight-bar-explore');

	const updateHighlightPosition = (element, value) => {
		const percent = ((value - yearRange[0]) / (yearRange[1] - yearRange[0])) * 100;
		element.style.left = `calc(${percent}% - 1px)`;
	};

	rangeSlider.noUiSlider.on('update', (values) => {
		rangeValues.innerHTML = `De ${values[0]} à ${values[1]}`;
		updateHighlightPosition(highlight1, parseInt(values[0]));
		updateHighlightPosition(highlight2, parseInt(values[1]));
	});

	exploreSlider.noUiSlider.on('update', (values) => {
		const start = parseInt(values[0]);
		const end = start + 1;
		exploreValues.innerHTML = `De ${start} à ${end}`;
		updateHighlightPosition(highlightExplore, start);
	});

	const timelineScale = document.getElementById('timeline-scale');
	const step = 5;
	for (let year = yearRange[0]; year <= yearRange[1]; year += step) {
		const tick = document.createElement('div');
		tick.className = 'tick';
		tick.textContent = year;
		timelineScale.appendChild(tick);
	}
</script>
</body>
</html>
